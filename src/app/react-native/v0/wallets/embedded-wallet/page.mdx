import { Details } from "@/components/Document";
import { WalletsBreadcrumb, CustomizeWalletConfigurator } from "../_components";
import { InstallTabs } from "@/components/Document/InstallTabs";

<WalletsBreadcrumb name="Embedded Wallet" slug="embedded-wallet" />

# EmbeddedWallet

A wallet configurator for [Embedded Wallet](/wallet/wallets/embedded-wallet/overview) which allows integrating the wallet with React Native

```tsx
import { embeddedWallet } from "@thirdweb-dev/react-native";

const embeddedWalletConfig = embeddedWallet();
```

<CustomizeWalletConfigurator
	config="embeddedWalletConfig"
	configurator="embeddedWallet"
	connectUI="embeddedWalletConnectUI"
	selectUI="embeddedWalletSelectUI"
/>

## Options

<Details summary="auth" tags={['Optional']}>

Whether to show the Sign In with different providers.

To use this feature you will need to enable the `Embedded Wallets` service for your `clientId`
in your [Dashboard Settings](https://thirdweb.com/dashboard/settings) and you will need to allowlist
your app's `redirectUrl` (more on this below).

`redirectUrl`: The `redirectUrl` must be a deeplink your app supports. This
is going to be used to redirect back from the browser when using socials sign in options (Google, Apple, etc).

We wrote [a short guide](/react-native/faq) to help you enable deep links support in your mobile app.

```ts
embeddedWallet({
	auth: {
		options: ["email", "google", "apple", "facebook"],
		redirectUrl: "deep-link-to-your-app://",
	},
});
```

</Details>

<Details summary="walletConnectReceiver" tags={["Optional"]}>

Allows your wallet to be connected to an external applicatoin via WalletConnect.

Defaults to `undefined`.

```
export type WalletConnectReceiverConfig = {
  walletConnectReceiver?:
    | {
        walletConnectWalletMetadata?: WCMetadata;
        walletConnectV2ProjectId?: string;
        walletConnectV2RelayUrl?: string;
      }
    | true;
};
```

</Details>

## Installation

To use the `embeddedWallet` you need to add the following dependencies to your project. Find the
command to add them all for convenience below.

<InstallTabs
	thirdwebInstallSupported
	npm="npm i amazon-cognito-identity-js@6.3.3 react-native-quick-base64 react-native-quick-crypto react-native-aes-gcm-crypto @react-native-community/netinfo react-native-inappbrowser-reborn@3.7.0"
	yarn="yarn add amazon-cognito-identity-js@6.3.3 react-native-quick-base64 react-native-quick-crypto react-native-aes-gcm-crypto @react-native-community/netinfo react-native-inappbrowser-reborn@3.7.0"
	pnpm="pnpm i amazon-cognito-identity-js@6.3.3 react-native-quick-base64 react-native-quick-crypto react-native-aes-gcm-crypto @react-native-community/netinfo react-native-inappbrowser-reborn@3.7.0"
/>

Here are the dependencies added:

- amazon-cognito-identity-js: "^6.3.3"
- react-native-quick-base64
- react-native-quick-crypto
- react-native-aes-gcm-crypto
  - This package requires minSdkVersion = 26 on Android
- @react-native-community/netinfo
- react-native-inappbrowser-reborn: "^3.7.0" (for Socials Sign In)

  - There's an open issue on RN > 0.72: https://github.com/margelo/react-native-quick-crypto/issues/186 which you can [fix by](https://github.com/margelo/react-native-quick-crypto/issues/186#issuecomment-1663666739) adding the following to your `android/app/build.gradle` file:

    ```
    packagingOptions {
        pickFirst 'lib/x86/libcrypto.so'
        pickFirst 'lib/x86_64/libcrypto.so'
        pickFirst 'lib/armeabi-v7a/libcrypto.so'
        pickFirst 'lib/arm64-v8a/libcrypto.so'
    }
    ```

  - When building the iOS app in release mode for RN 0.71 you need to enable the OpenSSL framework in XCode. There are several solutions for this here:
    - https://github.com/margelo/react-native-quick-crypto/issues/121#issuecomment-1369924076
    - https://github.com/margelo/react-native-quick-crypto/issues/121#issuecomment-1537576444

## Usage with ConnectWallet

To allow users to connect to this wallet using the [ConnectWallet](/react-native/v0/connecting-wallets#connect-wallet) component, you can add it to [ThirdwebProvider's supportedWallets](/react-native/v0/connecting-wallets#supported-wallets) prop.

```tsx
<ThirdwebProvider
	clientId="your-client-id"
	supportedWallets={[embeddedWallet()]}
>
	<YourApp />
</ThirdwebProvider>
```

## Usage with useEmbeddedWallet

You can use the [`useEmbeddedWallet`](/references/react-native/useEmbeddedWallet) hook to programmatically connect to the wallet without using the [ConnectWallet](/react-native/v0/connecting-wallets#connect-wallet) component.

The wallet also needs to be added in [ThirdwebProvider's supportedWallets](/react-native/v0/connecting-wallets#supported-wallets) if you want the wallet to auto-connect on next page load.

The hook will return all the necessary functions you'll need to authenticate and connect to the embedded wallet.

### Connecting with Google sign in

```tsx
function App() {
	const { connect } = useEmbeddedWallet();

	const handleConnect = async () => {
		await connect({
			strategy: "google",
			redirectUrl: "redirect-url-to-your-app://",
		});
	};

	return <View> ... </View>;
}
```

### Connecting with email verification

```tsx
function App() {
	const { connect, sendVerificationEmail } = useEmbeddedWallet();

	const preLogin = async (email: string) => {
		// send email verification code
		await sendVerificationEmail({ email });
	};

	const handleLogin = async (email: string, verificationCode: string) => {
		// verify email and connect
		await connect({
			strategy: "email",
			email,
			verificationCode,
		});
	};

	return <View> ... </View>;
}
```

## Available connection strategies

```ts
// email verification
type EmailVerificationAuthParams = {
	strategy: "email";
	email: string;
	verificationCode: string;
	recoveryCode?: string;
};

type SocialAuthParams = {
	strategy: "google" | "facebook" | "apple";
	redirectUrl: string;
};

// bring your own authentication
type JwtAuthParams = {
	strategy: "jwt";
	jwt: string;
	encryptionKey: string;
};
```
